<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="每天进步一点">
<meta property="og:type" content="website">
<meta property="og:title" content="记录点滴成长">
<meta property="og:url" content="http://jianwl.com/page/6/index.html">
<meta property="og:site_name" content="记录点滴成长">
<meta property="og:description" content="每天进步一点">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="记录点滴成长">
<meta name="twitter:description" content="每天进步一点">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://jianwl.com/page/6/"/>

  <title> 记录点滴成长 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">记录点滴成长</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-books">
          <a href="/books" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            书单
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/13/MYSQL之事务/" itemprop="url">
                  MYSQL之事务
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-13T11:07:35+08:00" content="2016-08-13">
              2016-08-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/MYSQL/" itemprop="url" rel="index">
                    <span itemprop="name">MYSQL</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/13/MYSQL之事务/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/13/MYSQL之事务/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h3><p>一组原子性的SQL查询，事务内的语句要么全部执行成功，要么全部执行失败。</p>
<h3 id="场景示例"><a href="#场景示例" class="headerlink" title="场景示例"></a>场景示例</h3><p>假设一个银行的数据库有两张表:支票(checking)表和储蓄(savings)表，现在用户Jane的支票账户转移200美元到她的储蓄账户，那么需要至少三个步骤：</p>
<ol>
<li>检查支票账户的余额高于200美元</li>
<li>从支票账户余额中减去200美元</li>
<li>在储蓄账户余额中增加200美元</li>
</ol>
<p>上述三个步骤必须打包在一个事务中，任何一个步骤失败，则必须回滚所有的步骤。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">START TRANSACTION;</div><div class="line">SELECT balance FROM checking where customer_id =  10233276;</div><div class="line">UPDATE checking SET balance = balance - 200.00 WHERE customer_id = 10233276;</div><div class="line">UPDATE savings SET balance = balance + 200.00  WHERE customer_id = 10233276;</div><div class="line">COMMIT</div></pre></td></tr></table></figure></p>
<p>但是….. 单纯的事务概念并不是故事的全部，可能会出现以下场景….</p>
<blockquote>
<ol>
<li>执行第4条语句时，服务器崩溃了 – 可能用户会损失200美金</li>
<li>在执行第3条语句和第4条语句之间，另外一个进程要删除支票账户的所有余额 – 银行在不知道这个逻辑的情况下， 可能白白给了Jane200美金。</li>
</ol>
</blockquote>
<h3 id="如何保障事务"><a href="#如何保障事务" class="headerlink" title="如何保障事务"></a>如何保障事务</h3><p>除非系统通过严格的ACID测试，否则空谈事务的概念是远远不够的。ACID分别表示原子性、一致性、隔离性、持久性。</p>
<p><strong>原子性(atomicity)</strong><br>一个事务必须被视为一个不可分割的最小工作单元，整个事务要么全部提交成功，要么全部失败回滚。</p>
<p><strong>一致性(consistency)</strong><br>数据库总是从一个一致性的状态转换到另外一个一致性的状态。例如：在前面的例子中，即使在执行第3、4条语句之间系统崩溃了，支票账户也不会损失200美元，因为事务最终没有被提交，事务中所做的修改也不会保存到数据库中。</p>
<p><strong>隔离性(isolation)</strong><br>一个事务所做的修改在最终提交以前，对其他事务是不可见的。例如：在前面的例子中，当执行完第3条语句，第4条语句还没有开始时，此时另外一个账号汇总程序开始运行，则其看到的支票账户的余额并没有被减去200美元。</p>
<p><strong>持久性(durability)</strong><br>一旦事务提交，则其所作的修改就会永久保存到数据库中，此时即使系统崩溃，修改的数据也不会丢失。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/12/Java设计模式之单例模式/" itemprop="url">
                  Java设计模式之单例模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-12T17:06:23+08:00" content="2016-08-12">
              2016-08-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/12/Java设计模式之单例模式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/12/Java设计模式之单例模式/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是单例模式？"><a href="#什么是单例模式？" class="headerlink" title="什么是单例模式？"></a>什么是单例模式？</h3><p>确保一个类只有一个实例，并提供一个全局访问点。</p>
<h3 id="常见的错误"><a href="#常见的错误" class="headerlink" title="常见的错误"></a>常见的错误</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//在多线程模式下，用这种方法获取单例对象是有问题的。</div><div class="line">public class Singleton &#123;</div><div class="line">    private static Singleton uniqueInstance;</div><div class="line">    private Singleton()&#123;&#125;</div><div class="line">    public static Singleton getInstance()&#123;</div><div class="line">        if(uniqueInstance == null)&#123;</div><div class="line">            uniqueInstance = new Singleton();</div><div class="line">        &#125;</div><div class="line">        return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="多线程模式下，正确获取单例的方法"><a href="#多线程模式下，正确获取单例的方法" class="headerlink" title="多线程模式下，正确获取单例的方法"></a>多线程模式下，正确获取单例的方法</h3><p><strong>方法1</strong>：获取单例的性能不高，但简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public class Singleton &#123;</div><div class="line">    private static Singleton uniqueInstance;</div><div class="line">    private Singleton()&#123;&#125;</div><div class="line">    public static synchronized Singleton getInstance()&#123;</div><div class="line">        if(uniqueInstance == null)&#123;</div><div class="line">            uniqueInstance = new Singleton();</div><div class="line">        &#125;</div><div class="line">        return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>方法2</strong>： 使用“急切”创建实例，而不是延迟实例化的做法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public class Singleton &#123;</div><div class="line">    private static Singleton uniqueInstance = new Singleton();</div><div class="line">    private Singleton()&#123;&#125;</div><div class="line">    public static  Singleton getInstance()&#123;</div><div class="line">      return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>方法3</strong>：使用双重加锁，在getInstance中减少使用同步<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public class Singleton &#123;</div><div class="line">    // volatile关键词确保，uniqueInstance初始化为singleton实例时，多个线程能够正确处理uniqueInstance变量。</div><div class="line">    private volatile static Singleton uniqueInstance;</div><div class="line">    private Singleton() &#123;</div><div class="line">    &#125;</div><div class="line">    public static Singleton getInstance() &#123;</div><div class="line">        if (uniqueInstance == null) &#123;</div><div class="line">            synchronized (Singleton.class) &#123;</div><div class="line">                if (uniqueInstance == null) &#123;</div><div class="line">                    uniqueInstance = new Singleton();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return uniqueInstance;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="多线程模式下，单例测试"><a href="#多线程模式下，单例测试" class="headerlink" title="多线程模式下，单例测试"></a>多线程模式下，单例测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//在多线程模式下，创建单例，若hashCode相等则为同一实例。</div><div class="line">public class SingletonTest &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        for(int i=0;i&lt;100;i++) &#123;</div><div class="line">            new Thread(() -&gt; &#123;</div><div class="line">                Singleton instanceOne = Singleton.getInstance();</div><div class="line">                System.out.println(instanceOne.hashCode());</div><div class="line">            &#125;).start();</div><div class="line">            new Thread(() -&gt; &#123;</div><div class="line">                Singleton instanceTwo = Singleton.getInstance();</div><div class="line">                System.out.println(instanceTwo.hashCode());</div><div class="line">            &#125;).start();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/12/Kafka介绍/" itemprop="url">
                  Kafka介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-12T00:34:02+08:00" content="2016-08-12">
              2016-08-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Kafka/" itemprop="url" rel="index">
                    <span itemprop="name">Kafka</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/12/Kafka介绍/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/12/Kafka介绍/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前工作中用到Kafka项目，近来面试，问到kafka的概念性部分，有些模糊，特写下此文，梳理知识点，备忘。</p>
<h3 id="什么是Kafka？"><a href="#什么是Kafka？" class="headerlink" title="什么是Kafka？"></a>什么是Kafka？</h3><p>Kafka是一个分布式(distributed)，可划分（partitioned）,冗余备份的持久化的日志服务(replicated committ log service),提供消息系统（messaging system）的功能。</p>
<p><strong>消息的基本术语</strong></p>
<ul>
<li><code>topics</code>  特指Kafka处理的消息源(feeds of messages)的不同分类</li>
<li><code>producers</code> 向Kafka的一个topic发布消息的过程叫producers</li>
<li><code>consumers</code>订阅topics并处理其发布的消息的过程叫consumers</li>
<li><code>broker</code> Kafka集群中的一台或多台服务器统称为broker</li>
</ul>
<p>所以，从总体来说，producers通过网络想Kafka的集群发送消息并转由consumers来处理，这个过程如图所示<br><img src="../images/producer_consumer.png" alt=""><br>客户端和服务端的通信，是基于简单、高性能且与编程语言无关的TCP协议</p>
<h3 id="Topic与日志"><a href="#Topic与日志" class="headerlink" title="Topic与日志"></a>Topic与日志</h3><p>一个Topic是指发布的消息的一个类别或消息源的名字，Kafka集群为每一个Topic划分一个日志(partitioned log)如下图所示<br><img src="../images/partitions.png" alt=""><br>每一个partition是一个排好序的，不可变的消息序列。新的消息不断的追加到序列的尾部。–即持久性日志（commit log）。每一个分区（partition）中的消息，有一个名叫offset 的顺序编号，作为这条消息在partition中的标识。</p>
<p>Kafka集群将在设定的时间范围内，保存所有被发布的消息，不论该消息是否被处理完成。例如，如果一个日志被设置为保存2天，那么在它发布的两天之内，它都是可以被处理的，而在2天之后，它就会被系统销毁并释放掉。</p>
<p>实际上，每个consumer中仅有的元数据（metadata）的主要部分是该consumer在日志中的位置信息，叫做offset（偏移量）。这个offset由consumer控制，在一般情况下，consumer按照offset的顺序读取消息，但事实上consumer可以控制位置，可以以任何想要的顺序处理消息。例如一个consumer可以重置并重新处理一个已经处理过的offset。</p>
<p>这些特点的组合使Kafka的consumers变得特别的廉价–它们能来去自如而不会对集群或者其它的consumers造成多大影响。比如，你可以使用我们的命令行工具来“tail”任意topic中的内容，而不会改变任何被已有consumers处理过的内容。</p>
<p>日志服务的分区有几个目的。首先，它允许日志扩展到超过单台服务器允许的大小。因为虽然每一个单独的分区必须适应承载它们的服务器，但是一个topic可以包含多个分区，所以能处理任意大小的数据。其次，它们作为并行单元–一会儿我们会了解更多</p>
<h3 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h3><p>日志的分区partitions分布式地部署在Kafka服务器集群上，每个服务器为一个共享的分区处理数据和请求。每一个分区的数据被冗余的备份在多台服务器上用于容错，可以通过配置来设定用于备份的服务器的数量。</p>
<p>每个分区有一台服务器扮演“领导”的角色，有0或多台服务器扮演“随从”。领导负责所有对分区的读写请求，同时随从们被作为领导的备份。一旦领导挂掉，随从中的一个会自动变成新的领导。每一台服务器都同时在一些分区里扮演领导而在另外一些分区中充当随从，这让集群拥有良好的负载均衡。</p>
<h3 id="Producers-（生产者）"><a href="#Producers-（生产者）" class="headerlink" title="Producers （生产者）"></a>Producers （生产者）</h3><p>producers向他们选择的topics发布数据。每个producer负责在topic中选择将哪些消息分配给哪些分区。这可以通过简单的“循环赛”的方式来或是根据一些语义划分的方法（比如根据一些消息中的键）来实现负载均衡。我们会在之后介绍如何使用分区时提供更多的信息。</p>
<h3 id="Consumers-（消费者）"><a href="#Consumers-（消费者）" class="headerlink" title="Consumers （消费者）"></a>Consumers （消费者）</h3><p>传统的消息系统有两种模式：消息队列和发布/订阅。在消息队列模式中，一池子的consumers可能从一个服务器上读取数据，每个消息被分发给其中一个consumer；而在发布订阅模式中，消息被以广播的方式发给所有的consumers。Kafka通过提供了一个叫做消费者群组（consumer group）的抽象概念涵盖以上两种模式。</p>
<p>Consumers上标记有他们所属的consumer group的名字，每个被发布到topic上的消息消息会被分发到所有订阅该topic的consumer group内部的一个consumer实例上。Consumer实例可以是一个单独的进程也可以是一个单独的机器。</p>
<p>如果所有的consumer实例都具有相同的群组，那么就像传统的队列模式一样平衡着各个consumer的负载。</p>
<p>如果所有的consumer实例均有不同的群组，那么这就如同发布/订阅模式，所有的消息被广播给所有的消费者。</p>
<p>更常见的情况是，我们发现topics一般只有很少的消费者群组，一个群组一般对应一个“逻辑订阅”单元。而每一个群组由大量的consumer实例构成，用来提供可扩展性和容错性。这其实就是发布/订阅模式的一种特殊情况，只不过订阅者是一个consumers的集群而非一个单独的进程而已。<br><img src="../images/consumer-groups.png" alt=""><br>同时，Kafka具有比传统消息系统更强大的顺序保障。</p>
<p>传统的队列在服务器上按照一定的顺序存储消息，然后当多个consumers从队列中处理消息时，系统按照消息存储的顺序分发消息。然而，虽然系统是按照顺序送出消息的，但是是按异步的方式送达到consumer手中，所以当消息到达不同consumer手中的时候，已经没有顺序可言了。这意味着消息的顺序在并行处理中不复存在了。消息系统常常有一个权宜之计来应对这种情况，就是使用了一个叫做“独家消费”的概念，就是只允许一个进程处理队列，不过这么做的话，并行处理当然也就不复存在了。</p>
<p>Kafka在这一点上做的比较好。通过一个叫做“排比(parallelism)”的概念–即并行–在topics中， Kafka能够同时提供顺序保证和一池子消费进程间的负载均衡。</p>
<p>Kafka只能保证每个分区内部的消息的总体顺序，而保证同一个topic在不同分区中消息的顺序。这种每个分区有序并可以按照数据的键去分区的特性对于大多数应用都已经足够。但是，如果你需要保证所有消息的总体顺序，可以通过使用只有一个分区的topic去完成，不过这样做就意味着只有一个consumer进程了。</p>
<h3 id="保障"><a href="#保障" class="headerlink" title="保障"></a>保障</h3><p>在高层次上Kafka提供如下保障：</p>
<ul>
<li>由producer发送给特点topic分区的消息按照发送的先后顺序排序。也就是说，如果同一个producer发送了消息M1和M2，M1先被发送，那么M1的offset比M2的小，且M1先出现在日志中。</li>
<li>一个consumer实例按照消息在日志中存储的顺序收到消息。</li>
<li>对于一个有N个备份的topic，我们允许其中N-1个服务器挂掉，依然能保证不丢失任何持久性日志中的消息。</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li>Kafka 0.8.1官方文档</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/11/锋利的JQuery-DOM操作/" itemprop="url">
                  锋利的JQuery -- DOM操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-11T23:56:08+08:00" content="2016-08-11">
              2016-08-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/11/锋利的JQuery-DOM操作/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/11/锋利的JQuery-DOM操作/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="查找节点"><a href="#查找节点" class="headerlink" title="查找节点"></a>查找节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">var $li = $(“ul  li:eq(1)”)</td>
<td style="text-align:left">查找元素节点</td>
</tr>
<tr>
<td style="text-align:left">var p_text = $(“p”).attr(“title”)</td>
<td style="text-align:left">查找属性节点</td>
</tr>
</tbody>
</table>
<h3 id="插入节点"><a href="#插入节点" class="headerlink" title="插入节点"></a>插入节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">B.append(A)</td>
<td style="text-align:left">向B内部追加A</td>
</tr>
<tr>
<td style="text-align:left">A.append(B)</td>
<td style="text-align:left">把A追加到B内部</td>
</tr>
<tr>
<td style="text-align:left">B.prepend(A)</td>
<td style="text-align:left">把B内部最前面添加A</td>
</tr>
<tr>
<td style="text-align:left">B.after(A)</td>
<td style="text-align:left">在B后面添加A</td>
</tr>
<tr>
<td style="text-align:left">A.insertAfter(B)</td>
<td style="text-align:left">把A插入B的后面</td>
</tr>
<tr>
<td style="text-align:left">B.before(A)</td>
<td style="text-align:left">在B的前面插入A</td>
</tr>
<tr>
<td style="text-align:left">A.insertBefore(B)</td>
<td style="text-align:left">在B的前面添加A</td>
</tr>
</tbody>
</table>
<h3 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">remove()</td>
<td style="text-align:left">返回的是删除的元素</td>
</tr>
<tr>
<td style="text-align:left">detach()</td>
<td style="text-align:left">与remove类似，但元素的事件和数据都保留</td>
</tr>
<tr>
<td style="text-align:left">empty</td>
<td style="text-align:left">清空节点，清空内部的对象</td>
</tr>
</tbody>
</table>
<h3 id="复制节点"><a href="#复制节点" class="headerlink" title="复制节点"></a>复制节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">clone()</td>
<td style="text-align:left">复制当前的节点</td>
</tr>
<tr>
<td style="text-align:left">clone(true)</td>
<td style="text-align:left">复制当前的节点以及绑定的事件</td>
</tr>
</tbody>
</table>
<h3 id="替换节点"><a href="#替换节点" class="headerlink" title="替换节点"></a>替换节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">replaceWith()</td>
<td style="text-align:left">替换标签</td>
</tr>
</tbody>
</table>
<h3 id="属性操作"><a href="#属性操作" class="headerlink" title="属性操作"></a>属性操作</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">attr(“title”,”xxxx”)</td>
<td style="text-align:left">设置参数值</td>
</tr>
<tr>
<td style="text-align:left">attr(“title”)</td>
<td style="text-align:left">获取属性值</td>
</tr>
<tr>
<td style="text-align:left">removeAttr(“title”)</td>
<td style="text-align:left">删除属性值</td>
</tr>
</tbody>
</table>
<h3 id="样式操作"><a href="#样式操作" class="headerlink" title="样式操作"></a>样式操作</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">attr(“class”,”xxx”)</td>
<td style="text-align:left">设置样式</td>
</tr>
<tr>
<td style="text-align:left">addClass(“xxx”)</td>
<td style="text-align:left">追加样式</td>
</tr>
<tr>
<td style="text-align:left">removeClass(“xxx”)</td>
<td style="text-align:left">移除样式</td>
</tr>
<tr>
<td style="text-align:left">removeClass()</td>
<td style="text-align:left">移除所有样式</td>
</tr>
<tr>
<td style="text-align:left">toggleClass(“xxx”)</td>
<td style="text-align:left">切换样式</td>
</tr>
<tr>
<td style="text-align:left">hasClass(“xxx”)</td>
<td style="text-align:left">判断是否有样式</td>
</tr>
</tbody>
</table>
<h3 id="设置、获取HTML、文本和值"><a href="#设置、获取HTML、文本和值" class="headerlink" title="设置、获取HTML、文本和值"></a>设置、获取HTML、文本和值</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">html()</td>
<td style="text-align:left">设置或者获取HTML</td>
</tr>
<tr>
<td style="text-align:left">text()</td>
<td style="text-align:left">设置或者获取文本</td>
</tr>
<tr>
<td style="text-align:left">val()</td>
<td style="text-align:left">设置获取值</td>
</tr>
</tbody>
</table>
<h3 id="遍历节点"><a href="#遍历节点" class="headerlink" title="遍历节点"></a>遍历节点</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">children()</td>
<td style="text-align:left">取得匹配元素的子元素集合</td>
</tr>
<tr>
<td style="text-align:left">next()</td>
<td style="text-align:left">取得匹配元素的下一个同辈元素</td>
</tr>
<tr>
<td style="text-align:left">prev()</td>
<td style="text-align:left">取得匹配元素的前一个同辈元素</td>
</tr>
<tr>
<td style="text-align:left">siblings()</td>
<td style="text-align:left">取得匹配元素的所有同辈元素</td>
</tr>
<tr>
<td style="text-align:left">parent()</td>
<td style="text-align:left">获得集合中每个元素的祖先元素</td>
</tr>
<tr>
<td style="text-align:left">parents()</td>
<td style="text-align:left">获得每个元素的祖先元素</td>
</tr>
<tr>
<td style="text-align:left">closest()</td>
<td style="text-align:left">从本身开始，返回最先匹配的祖先元素</td>
</tr>
</tbody>
</table>
<h3 id="CSS-DOM操作"><a href="#CSS-DOM操作" class="headerlink" title="CSS-DOM操作"></a>CSS-DOM操作</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">css(“color”)</td>
<td style="text-align:left">获得指定的样式值</td>
</tr>
<tr>
<td style="text-align:left">css(“color”,”red”)</td>
<td style="text-align:left">设置指定样式</td>
</tr>
<tr>
<td style="text-align:left">width() height()</td>
<td style="text-align:left">设置获取宽度和高度</td>
</tr>
<tr>
<td style="text-align:left">offset()</td>
<td style="text-align:left">视窗的偏移值</td>
</tr>
<tr>
<td style="text-align:left">position()</td>
<td style="text-align:left">获取定对于最近的position样式元素的位置</td>
</tr>
<tr>
<td style="text-align:left">scrollTop</td>
<td style="text-align:left">滚动条顶端距离</td>
</tr>
<tr>
<td style="text-align:left">scrollLeft()</td>
<td style="text-align:left">滚动条左端距离</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/11/锋利的JQuery-Ajax/" itemprop="url">
                  锋利的JQuery -- Ajax
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-11T23:34:28+08:00" content="2016-08-11">
              2016-08-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/11/锋利的JQuery-Ajax/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/11/锋利的JQuery-Ajax/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Ajax的优劣"><a href="#Ajax的优劣" class="headerlink" title="Ajax的优劣"></a>Ajax的优劣</h3><p>优点</p>
<ul>
<li>不需要插件支持</li>
<li>优秀的用户体验</li>
<li>提高web程序的性能</li>
<li>减轻服务器和带宽的压力</li>
</ul>
<p>缺点</p>
<ul>
<li>浏览器对XHLHttpRequest支持度不够</li>
<li>破坏浏览器的前进、后退按钮</li>
<li>对搜索引擎的支持不足</li>
<li>开发和调试工具的匮乏</li>
</ul>
<h3 id="Ajax方法"><a href="#Ajax方法" class="headerlink" title="Ajax方法"></a>Ajax方法</h3><table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">示例</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">load()</td>
<td style="text-align:left">load(url,data,callback)</td>
<td style="text-align:left">载入HTML文档</td>
</tr>
<tr>
<td style="text-align:left">get()</td>
<td style="text-align:left">$.get(url,data,callback,type)</td>
<td style="text-align:left">GET方式发送请求</td>
</tr>
<tr>
<td style="text-align:left">post</td>
<td style="text-align:left">$.post(url,data,callback,type)</td>
<td style="text-align:left">POST方式发送请求</td>
</tr>
<tr>
<td style="text-align:left">getScript</td>
<td style="text-align:left">$.getScript(‘test.js’,callback)</td>
<td style="text-align:left">动态加载js</td>
</tr>
<tr>
<td style="text-align:left">getJSON()</td>
<td style="text-align:left">$.getJSON(‘test.json’,function(data){})</td>
<td style="text-align:left">加载JSON,data为JSON内容</td>
</tr>
</tbody>
</table>
<p><strong>ajax()为最常用、最基本的方法，常用参数:</strong></p>
<ul>
<li><code>url</code> 请求的地址</li>
<li><code>type</code> 请求的类型，默认GET</li>
<li><code>timeout</code> 超时时间</li>
<li><code>data</code> 请求的数据</li>
<li><code>dataType</code> 返回数据类型</li>
<li><code>success</code> 成功回调</li>
<li><code>error</code> 失败回调</li>
<li><code>complete</code> 完成回调</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/11/锋利的Query-选择器/" itemprop="url">
                  锋利的Query -- 选择器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-11T19:13:30+08:00" content="2016-08-11">
              2016-08-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/11/锋利的Query-选择器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/11/锋利的Query-选择器/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">E{CSS}</td>
<td style="text-align:left">标签选择器</td>
</tr>
<tr>
<td style="text-align:left">#ID{CSS}</td>
<td style="text-align:left">id选择器</td>
</tr>
<tr>
<td style="text-align:left">E.className{CSS}</td>
<td style="text-align:left">类选择器</td>
</tr>
<tr>
<td style="text-align:left">E1，E2，E3{CSS}</td>
<td style="text-align:left">群组选择器</td>
</tr>
<tr>
<td style="text-align:left">E F{CSS}</td>
<td style="text-align:left">后代选择器</td>
</tr>
<tr>
<td style="text-align:left">*{CSS}</td>
<td style="text-align:left">统配选择器</td>
</tr>
</tbody>
</table>
<h3 id="基本选择器"><a href="#基本选择器" class="headerlink" title="基本选择器"></a>基本选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“#one”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变id为one的元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“.one”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变class为one的元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变元素名为div的元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“*”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变所有元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“span. #one”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变所有span和id为one的元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="层次选择器"><a href="#层次选择器" class="headerlink" title="层次选择器"></a>层次选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“body div”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变<body>内所有div的背景色</body></td>
</tr>
<tr>
<td style="text-align:left">$(“body &gt;div”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变<body>内子div的背景色</body></td>
</tr>
<tr>
<td style="text-align:left">$(“.one + div”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变class为one的下一个div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“#two ~ div”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变id为two的后面的所有同辈div元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="内容过滤选择器"><a href="#内容过滤选择器" class="headerlink" title="内容过滤选择器"></a>内容过滤选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“div:contains(di)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变 含有文本di的div元素背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div:empty”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变不包含子元素的div的空元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div:has(“.mini”)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变class为mini元素的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div:parent”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有子元素的div元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="可见性过滤选择器"><a href="#可见性过滤选择器" class="headerlink" title="可见性过滤选择器"></a>可见性过滤选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“div:visible”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变所有可见的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div:hidden”).show(3000)</td>
<td style="text-align:left">显示所有隐藏的div元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="属性过滤选择器"><a href="#属性过滤选择器" class="headerlink" title="属性过滤选择器"></a>属性过滤选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“div[title]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title!=test]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title不等于test的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title^=te]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title以te开头的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title$=est]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title以est结尾的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title*=es]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title含有es的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[id][title*=es]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性id,并且title含有es的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title=’en’]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title等于en或者以en为前缀(en-xxx)的的div元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div[title~=’uk’]”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变含有属性title用空格分隔的值中包含字符uk的div元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="子元素过滤选择器"><a href="#子元素过滤选择器" class="headerlink" title="子元素过滤选择器"></a>子元素过滤选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“div.one:nth-child(2)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变每个class为one的div父元素下的第二个子元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div.one:first-child)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变每个class为one的div父元素中的第一个子元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div.one:last-child)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变每个class为one的div父元素中的最后一个子元素的背景色</td>
</tr>
<tr>
<td style="text-align:left">$(“div.one:only-child)”).css(“background”,”#bbffaa”)</td>
<td style="text-align:left">改变每个class为one的div父元素下只有一个子元素，则改变该子元素的背景色</td>
</tr>
</tbody>
</table>
<h3 id="表单对象属性过滤选择器"><a href="#表单对象属性过滤选择器" class="headerlink" title="表单对象属性过滤选择器"></a>表单对象属性过滤选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“form1 input:enabled”).val(“这里变化了!”)</td>
<td style="text-align:left">改变表单内可用input元素的值</td>
</tr>
<tr>
<td style="text-align:left">$(“form1 input:disabled”).val(“这里变化了!”)</td>
<td style="text-align:left">改变表单内不可用input元素的值</td>
</tr>
<tr>
<td style="text-align:left">$(“input:checked”).length</td>
<td style="text-align:left">改变多选框中的个数</td>
</tr>
<tr>
<td style="text-align:left">$(“select:selected”).text()</td>
<td style="text-align:left">获取下拉框选中的内容</td>
</tr>
</tbody>
</table>
<h3 id="表单选择器"><a href="#表单选择器" class="headerlink" title="表单选择器"></a>表单选择器</h3><table>
<thead>
<tr>
<th style="text-align:left">操作</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">$(“#form1 :input”)</td>
<td style="text-align:left">获得表单中所有的input、textarea、select、button元素</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :text”)</td>
<td style="text-align:left">获得所有的单行文本框</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :password”)</td>
<td style="text-align:left">获得所有的密码框</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :radio”)</td>
<td style="text-align:left">获得所有的单选框</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :checkbox”)</td>
<td style="text-align:left">获得所有的多选框</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :submit”)</td>
<td style="text-align:left">获得所有的提交按钮</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :image”)</td>
<td style="text-align:left">获得所有的图片按钮</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :reset”)</td>
<td style="text-align:left">获得所有的重置按钮</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :button”)</td>
<td style="text-align:left">获得所有的按钮</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :file”)</td>
<td style="text-align:left">获得所有的上传域</td>
</tr>
<tr>
<td style="text-align:left">$(“#form1 :hidden”)</td>
<td style="text-align:left">获得所有的不可见元素</td>
</tr>
</tbody>
</table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li>锋利的JQuery（第2版）</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/11/Java设计模式之模板方法模式/" itemprop="url">
                  Java设计模式之模板方法模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-11T17:30:24+08:00" content="2016-08-11">
              2016-08-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/11/Java设计模式之模板方法模式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/11/Java设计模式之模板方法模式/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="场景定义"><a href="#场景定义" class="headerlink" title="场景定义"></a>场景定义</h3><p>星巴克咖啡师傅训练手册，饮料的冲泡方法。<br><strong>星巴玆咖啡冲泡法</strong></p>
<ol>
<li>把水煮沸</li>
<li>把沸水冲泡咖啡</li>
<li>把咖啡倒进杯子</li>
<li>加糖和牛奶</li>
</ol>
<p><strong>星巴玆茶冲泡法</strong></p>
<ol>
<li>把水煮沸</li>
<li>用沸水浸泡茶叶</li>
<li>把茶倒进杯子</li>
<li>加柠檬</li>
</ol>
<h3 id="不考虑设计模式的做法"><a href="#不考虑设计模式的做法" class="headerlink" title="不考虑设计模式的做法"></a>不考虑设计模式的做法</h3><p>Coffee.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">public class Coffee &#123;</div><div class="line">    //咖啡冲泡法</div><div class="line">    void prepareRecipe() &#123;</div><div class="line">        boilWater();</div><div class="line">        brewCoffeeCrinds();</div><div class="line">        pourInCup();</div><div class="line">        addSugarAndMilk();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void boilWater() &#123;</div><div class="line">        System.out.println(&quot;Boiling water&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void brewCoffeeCrinds() &#123;</div><div class="line">        System.out.println(&quot;Dripping Coffee through filter&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void pourInCup() &#123;</div><div class="line">        System.out.println(&quot;Pouring into cup&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void addSugarAndMilk() &#123;</div><div class="line">        System.out.println(&quot;Adding sugar and milk&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Tea.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">public class Tea &#123;</div><div class="line">    //茶冲泡法</div><div class="line">    void prepareRecipe() &#123;</div><div class="line">        boilWater();</div><div class="line">        steepTeaBag();</div><div class="line">        pourInCup();</div><div class="line">        addLemon();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void boilWater() &#123;</div><div class="line">        System.out.println(&quot;Boiling water&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void steepTeaBag() &#123;</div><div class="line">        System.out.println(&quot;Steeping the tea&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void pourInCup() &#123;</div><div class="line">        System.out.println(&quot;Pouring into cup&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void addLemon() &#123;</div><div class="line">        System.out.println(&quot;Adding Lemon&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Coffee和Tea两个类的实现很像，除了第2和第4个步骤不一样，基本上是相同的，出现了重复的代码，我们将通过模板方法模式来删除重复代码。</p>
<h3 id="使用设计模式的做法"><a href="#使用设计模式的做法" class="headerlink" title="使用设计模式的做法"></a>使用设计模式的做法</h3><ol>
<li><p>两份冲泡法都采用相同的算法，我们将抽象化prepareReceipe方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void prepareRecipe() &#123;</div><div class="line">    boilWater();</div><div class="line">    brew();</div><div class="line">    pourInCup();</div><div class="line">    addCondiments();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>定义一个抽象类CaffeineBeverage，相同的模块有具体实现，不同的模块定义为抽象方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">public abstract class CoffeineBeverage &#123;</div><div class="line">    //子类不能覆盖这个方法</div><div class="line">    final void prepareRecipe()&#123;</div><div class="line">        boilWater();</div><div class="line">        brew();</div><div class="line">        pourInCup();</div><div class="line">        addCondiments();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public abstract void brew() ;</div><div class="line"></div><div class="line">    public abstract void addCondiments();</div><div class="line"></div><div class="line">    public void boilWater() &#123;</div><div class="line">        System.out.println(&quot;Boiling water&quot;);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    public void pourInCup() &#123;</div><div class="line">        System.out.println(&quot;Pouring into cup&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Coffee和Tea继承抽象类，自行处理冲泡和添加调料部分<br>Coffee.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Coffee extends CoffeineBeverage&#123;</div><div class="line">    @Override</div><div class="line">    public void brew() &#123;</div><div class="line">        System.out.println(&quot;Boiling water&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void addCondiments() &#123;</div><div class="line">        System.out.println(&quot;Adding sugar and milk&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Tea.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Tea extends CoffeineBeverage&#123;</div><div class="line">    @Override</div><div class="line">    public void brew() &#123;</div><div class="line">        System.out.println(&quot;Steeping the tea&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void addCondiments() &#123;</div><div class="line">        System.out.println(&quot;Add Lemon&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="什么是模板方法模式？"><a href="#什么是模板方法模式？" class="headerlink" title="什么是模板方法模式？"></a>什么是模板方法模式？</h3><p>至此你已经了解如何使用模板方法模式了，接下来让我们了解一下，模板方法的定义。<br><strong>模板方法定义</strong><br>在一个方法中定义一个算法的骨架，而将一些步骤延迟到子类中，模板方法使得子类可以在不改变算法结构的情况下，重新定义算法中的某些步骤。</p>
<p><strong>使用场景</strong><br>这个模式是用来创建一个算法模板，什么是模板？模板是一个方法，这个方法将算法定义成一组步骤，其中的任何步骤都可以是抽象的，由子类负责实现，这可以确保算法的结构保持不变，同时由子类提供部分实现。</p>
<h3 id="延伸"><a href="#延伸" class="headerlink" title="延伸"></a>延伸</h3><p><strong>如果我不想要在饮料中添加调料，怎么做呢？</strong> 可以对模板方法进行挂钩，在抽象方法中声明钩子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">public abstract class CoffeineBeverage &#123;</div><div class="line">    //子类不能覆盖这个方法</div><div class="line">    final void prepareRecipe()&#123;</div><div class="line">        boilWater();</div><div class="line">        brew();</div><div class="line">        pourInCup();</div><div class="line">        if(customerWantsCondiments()) &#123;</div><div class="line">            addCondiments();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // 子类可以覆盖这个方法</div><div class="line">    public  boolean customerWantsCondiments()&#123;</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public abstract void brew() ;</div><div class="line"></div><div class="line">    public abstract void addCondiments();</div><div class="line"></div><div class="line">    public void boilWater() &#123;</div><div class="line">        System.out.println(&quot;Boiling water&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void pourInCup() &#123;</div><div class="line">        System.out.println(&quot;Pouring into cup&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li>Head First 设计模式</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/10/Java-IO-文件/" itemprop="url">
                  Java IO: 文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-10T17:09:21+08:00" content="2016-08-10">
              2016-08-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/10/Java-IO-文件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/10/Java-IO-文件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><p>如果你需要在不同端之间读取文件，你可以根据该文件是二进制文件/文本文件来选择使用<code>FileInputStream</code>/<code>FileReader</code>。这两个类允许你从文件开始到文件末尾读取一个字节/字符，或者将读取到的字节/字符。你不必一次性读取整个文件，你可以按顺序读取文件中的字节和字符。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">public class FileInputStreamDemo &#123;</div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        try &#123;</div><div class="line">            //新建一个FileInputStream对象</div><div class="line">            FileInputStream input = new FileInputStream(new File(&quot;D:\\input.txt&quot;));</div><div class="line"></div><div class="line">            // 文件的字节数</div><div class="line">            Integer size = input.available(); </div><div class="line">            byte[] b = new byte[size];</div><div class="line">            </div><div class="line">            //将文件中的内容读取到数组中</div><div class="line">            input.read(b);</div><div class="line">            input.close();</div><div class="line">            System.out.println(new String(b));</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h3><p>如果你需要在不同端之间读取文件，你可以根据该文件是二进制文件/文本文件来选择使用<code>FileInputStream</code>/<code>FileReader</code>。这两个类允许你从文件开始到文件末尾读取一个字节/字符，或者将读取到的字节/字符。你不必一次性读取整个文件，你可以按顺序读取文件中的字节和字符。</p>
<h3 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h3>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/10/Java-IO概述/" itemprop="url">
                  Java IO概述
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-10T16:11:52+08:00" content="2016-08-10">
              2016-08-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/10/Java-IO概述/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/10/Java-IO概述/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="JAVA-IO-是什么？"><a href="#JAVA-IO-是什么？" class="headerlink" title="JAVA IO 是什么？"></a>JAVA IO 是什么？</h3><p>Java IO是一套Java用来读写数据的API，大部分程序都需要处理一些输入并由输入产生一些输出，为此Java提供了java.io包。</p>
<h3 id="Java-io包的范围"><a href="#Java-io包的范围" class="headerlink" title="Java.io包的范围"></a>Java.io包的范围</h3><p>java.io包并没有涵盖所有输入输出类型，例如不包含GUI或网页上的读写。其主要涉及文件、网络数据流、内存缓冲等的读写。</p>
<h3 id="Java-IO的用途和特征"><a href="#Java-IO的用途和特征" class="headerlink" title="Java IO的用途和特征"></a>Java IO的用途和特征</h3><p>Java IO中包含许多InputStream、OutputStream、Reader、Writer的子类，这样设计的原因是让每一个类都负责不同的功能，各类用途汇总如下：</p>
<ul>
<li>文件访问</li>
<li>网络访问</li>
<li>内存缓冲访问</li>
<li>线程内部通信（管道）</li>
<li>缓冲</li>
<li>解析</li>
<li>读写文本（Readers/Writers）</li>
<li>读写基本类型数据</li>
<li>读写对象</li>
</ul>
<h3 id="Java-IO类概述表"><a href="#Java-IO类概述表" class="headerlink" title="Java IO类概述表"></a>Java IO类概述表</h3><p><img src="../images/java-io.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/07/Spring-Test单元测试/" itemprop="url">
                  Spring Test单元测试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-07T22:08:31+08:00" content="2016-08-07">
              2016-08-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/07/Spring-Test单元测试/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/07/Spring-Test单元测试/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="单元测试的好处？"><a href="#单元测试的好处？" class="headerlink" title="单元测试的好处？"></a>单元测试的好处？</h3><ul>
<li>缩短发现问题到解决问题的速度</li>
<li>验证程序修改后是否正确</li>
<li>如果是开源软件，通过单元测试可以了解软件是怎么使用的</li>
</ul>
<h3 id="Spring-Boot-Test常用注解"><a href="#Spring-Boot-Test常用注解" class="headerlink" title="Spring Boot Test常用注解"></a>Spring Boot Test常用注解</h3><p>当前使用SpringBoot的版本为1.4.0 Release</p>
<ul>
<li>@RunWith(SpringRunner.class) <code>运行Junit并支持Spring-test特性</code></li>
<li><p>@SpringBootTest  <code>为springApplication创建上下文并支持SpringBoot特性</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@SpringBootTest的webEnvironment属性有以下4种</div><div class="line">1、Mock —— 加载WebApplicationContext并提供Mock Servlet环境</div><div class="line">2、RANDOOM_PORT —— 加载EmbeddedWebApplicationContext并提供servlet环境，内嵌服务的监听端口是随机的</div><div class="line">3、DEFINED_PORT —— 加载EmbeddedWebApplicationContext并提供servlet环境，内容服务的监听端口是定义好的。默认端口是8080</div><div class="line">4、NONE —— 加载ApplicationContext，启动SpringApplication时，不支持Servlet环境</div></pre></td></tr></table></figure>
</li>
<li><p>@MockBean <code>声明需要模拟的服务</code></p>
</li>
<li><p>@SpyBean <code>定制化需要模拟服务的某个方法，即部分方法可以mock，部分方法可以调用真实方法</code></p>
</li>
<li><p>@WebMvcTest <code>自动加载Spring MVC配置、MockMvc配置、并扫描注解类</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">在没有@WebMvcTest注解时，使用@AutoConfiureMockMvc可以自动配置MockMvc;</div></pre></td></tr></table></figure>
</li>
<li><p>@Transaction <code>开启事务，回滚测试方法对数据库的改变</code></p>
</li>
</ul>
<h3 id="SpringBoot-Test-实战"><a href="#SpringBoot-Test-实战" class="headerlink" title="SpringBoot Test 实战"></a>SpringBoot Test 实战</h3><ul>
<li><p>使用Mock，对Controller层接口进行测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">@RunWith(SpringRunner.class)</div><div class="line">@WebMvcTest(UserController.class)</div><div class="line">public class UserControllerTest &#123;</div><div class="line">    @Autowired</div><div class="line">    private MockMvc mockMvc;</div><div class="line"></div><div class="line">    @MockBean</div><div class="line">    private UserService userService;</div><div class="line"></div><div class="line">    @Before</div><div class="line">    public void mockUserService()&#123;</div><div class="line">        User user = new User(1,&quot;liuyun&quot;,&quot;123456&quot;);</div><div class="line">        given(userService.add(user)).willReturn(true);</div><div class="line">        given(userService.selectById(1)).willReturn(user);</div><div class="line">     given(userService.selectAll()).willReturn(Arrays.asList(user));</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    /**</div><div class="line">     * 用户列表</div><div class="line">     */</div><div class="line">    @Test</div><div class="line">    public void listTest() throws Exception &#123;</div><div class="line">        mockMvc.perform(get(&quot;/list&quot;)</div><div class="line">                .accept(MediaType.APPLICATION_JSON))</div><div class="line">                .andDo(print())</div><div class="line">                .andExpect(status().isOk());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>使用mock，模拟对数据库的操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringRunner.class)</div><div class="line">@SpringBootTest</div><div class="line">public class UserServiceTest &#123;</div><div class="line"></div><div class="line">    @MockBean</div><div class="line">    private UserDao userDao;</div><div class="line"></div><div class="line">    @Autowired</div><div class="line">    private UserService userService;</div><div class="line"></div><div class="line">    @Before</div><div class="line">    public void initUserDao()&#123;</div><div class="line">        given(this.userDao.selectAll()).willReturn(Arrays.asList(new User(12231,&quot;zhangsan&quot;,&quot;234&quot;)));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void listTest()&#123;</div><div class="line">        List&lt;User&gt; users = userService.selectAll();</div><div class="line">        log.info(new Gson().toJson(users));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>回滚测试方法对数据库状态的影响</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringRunner.class)</div><div class="line">@SpringBootTest</div><div class="line">public class TransactionTest &#123;</div><div class="line">    @Autowired</div><div class="line">    private UserService userSerivce;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    @Transactional</div><div class="line">    public void add() throws Exception &#123;</div><div class="line">        //初始化用户表</div><div class="line">        userSerivce.deleteAll();</div><div class="line"></div><div class="line">        // 新增2个用户</div><div class="line">        userSerivce.add(new User(1,&quot;liuyun&quot;,&quot;123456&quot;));</div><div class="line">        userSerivce.add(new User(2,&quot;xiaofeng&quot;,&quot;123456&quot;));</div><div class="line">        Assert.assertEquals(2, userSerivce.selectAll().size());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个测试方法的功能是，往数据库中添加两条记录，加上@Transaction注解后，执行完测试方法，数据库状态将自动回滚到执行这个方法前的状态。</p>
</li>
</ul>
<h3 id="JUnit常用注解"><a href="#JUnit常用注解" class="headerlink" title="JUnit常用注解"></a>JUnit常用注解</h3><ul>
<li>@Before 、@After <code>测试方法前/后运行</code></li>
<li>@BeforeClass 、@AfterClass <code>测试类前/后运行，为静态方法</code></li>
<li>@Test @ignore(“reason”) <code>忽略此测试方法</code></li>
<li>@Test(timeout=1) <code>测试方法运行时间超过1毫秒，则自动失败</code></li>
</ul>
<h3 id="JUnit常用注解实战"><a href="#JUnit常用注解实战" class="headerlink" title="JUnit常用注解实战"></a>JUnit常用注解实战</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringRunner.class)</div><div class="line">@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.NONE)</div><div class="line">public class CommonAnnatationTest &#123;</div><div class="line">    @Before</div><div class="line">    public void before() &#123;</div><div class="line">        log.info(&quot;before&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @After</div><div class="line">    public void after() &#123;</div><div class="line">        log.info(&quot;after&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @BeforeClass</div><div class="line">    public static void beforeClass() &#123;</div><div class="line">        log.info(&quot;beforeClass&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @AfterClass</div><div class="line">    public static void afterClass() &#123;</div><div class="line">        log.info(&quot;afterClass&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void test_a() &#123;</div><div class="line">        log.info(&quot;test_a&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Ignore(&quot;废弃方法&quot;)</div><div class="line">    @Test</div><div class="line">    public void test_ignore() &#123;</div><div class="line">        log.info(&quot;ignore&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test(timeout = 1)</div><div class="line">    public void test_timeout() &#123;</div><div class="line">        Integer count = 0;</div><div class="line">        do &#123;</div><div class="line">            count++;</div><div class="line">        &#125; while (count &gt; 0);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="JUnit常用测试类型"><a href="#JUnit常用测试类型" class="headerlink" title="JUnit常用测试类型"></a>JUnit常用测试类型</h3><ul>
<li><p>集合测试 </p>
<p>SuiteA.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringJUnit4ClassRunner.class)</div><div class="line">@SpringBootTest</div><div class="line">public class SuiteA &#123;</div><div class="line">    @Test</div><div class="line">    public void test_a()&#123;</div><div class="line">        log.info(&quot;A&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void test_b()&#123;</div><div class="line">        log.info(&quot;B&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>SuiteB.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringJUnit4ClassRunner.class)</div><div class="line">@SpringBootTest</div><div class="line">public class SuiteB &#123;</div><div class="line">    @Test</div><div class="line">    public void test_c()&#123;</div><div class="line">        log.info(&quot;C&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void test_d()&#123;</div><div class="line">        log.info(&quot;D&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>SuiteTest.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@RunWith(Suite.class)</div><div class="line">@Suite.SuiteClasses(&#123;SuiteA.class,SuiteB.class&#125;)</div><div class="line">@SpringBootTest</div><div class="line">public class SuiteTest &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行SuiteTest,将测试SuiteA、SuiteB的所有测试方法</p>
</li>
<li><p>单元目录测试</p>
<p>目录1：Fruit.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public interface Drinking &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>目录2：Drinking.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public interface Drinking &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>CategoryTest.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!-- @Slf4j 是lombok注解--&gt;</div><div class="line">@Slf4j</div><div class="line">@RunWith(SpringRunner.class)</div><div class="line">@SpringBootTest</div><div class="line">public class CategoryTest &#123;</div><div class="line">    @Test</div><div class="line">    @Category(Fruit.class)</div><div class="line">    public void getFruitName() &#123;</div><div class="line">        log.info(&quot;I am Banana!&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    @Category(Drinking.class)</div><div class="line">    public void getDrinkingName() &#123;</div><div class="line">        log.info(&quot;I am water!&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>SuiteCategoriesTest.class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@RunWith(Categories.class)</div><div class="line">@Suite.SuiteClasses(&#123;CategoryTest.class&#125;)</div><div class="line">@Categories.IncludeCategory(Fruit.class)</div><div class="line">@SpringBootTest</div><div class="line">public class SuiteCategoriesTest &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行SuiteCategoriesTest,将会运行CategoryTest测试类下，getFruitName()方法。</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://oc5a5l0a0.bkt.clouddn.com/16-10-7/31807945.jpg"
               alt="流云" />
          <p class="site-author-name" itemprop="name">流云</p>
          <p class="site-description motion-element" itemprop="description">每天进步一点</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">128</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">28</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">流云</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jianwl"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
