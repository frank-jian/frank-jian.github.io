---
title: Redis之RDB持久化
date: 2016-04-18 09:37:36
tags: [Redis]
categories: Redis
---
## 	为何要持久化？
Redis是内存数据库，它将自己的数据库状态存在内存里面，如果不想办法将储存在内存中的数据库状态保存到磁盘里面，那么一旦服务器进程退出，服务器中的数据库状态也会消失不见。

为了解决这个问题，Redis提供了RDB的功能，RDB持久化生成的RDB文件是一个经过压缩的二进制文件，通过二进制文件可以还原生成RDB文件时的数据库状态。
## RDB文件的创建
生成RDB文件的两种命令：
1. SAVE
2. BGSAVE

SAVE命令会**阻塞**Redis服务器进程，直到RDB文件创建完毕为止，在服务器进程阻塞期间，服务器不能处理任何命令请求。

BGSAVE命令会派生出一个子进程，然后由子进程负责创建RDB文件，服务器进程(父进程)继续处理命令请求。
## 自动间隔性保存
用户可以通过设置服务器配置的save选项设置多个保存条件，但只要其中任意一个条件被满足，服务器就会执行BGSAVE操作。

举个例子，如果我们向服务器提供以下配置：
```
save  900  1    //服务器在900秒之内，对数据库进行了至少一次修改
save  300  10  
save  60    10000
```
只要满足以上三个条件中任意之一，BGSAVE命令就会被执行。
